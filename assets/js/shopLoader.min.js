const popup=document.getElementById("popup"),shownStyle="background: rgba(119,119,119,0.4);cursor: pointer;height: 100%;position: fixed;text-align: center;top: 0;width: 100%;z-index: 10000;backdrop-filter: blur(5px);transition-duration: 0.4s;transform: scale(1);/*display: none;*/",hiddenStyle="background: rgba(119,119,119,0.4);cursor: pointer;height: 100%;position: fixed;text-align: center;top: 0;width: 100%;z-index: 10000;backdrop-filter: blur(5px);display: none;transition-duration: 0.4s;transform: scale();";popup.style=hiddenStyle;let open=!1;const rarityColors={common:"rgb(200,200,200)",rare:"rgb(100,200,100)",super_rare:"rgb(100,150,200)",epic:"rgb(200,100,200)",legendary:"rgb(220,220,10)",uber:"rgb(255,0,0)"};async function hi(){let e=await fetch((localStorage.getItem("dev")?"http://localhost:8080":"https://api.dazai.app")+"/eco/getShop",{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}});if(!e.ok)return window.location.href=window.location.href.match(/(http(s:|:)\/\/)[^\/]+/)[0]+"/login";for(e=await e.json(),console.log(e),document.getElementById("username").innerText=e.userInfo.name,document.getElementById("coins").innerText=e.userInfo.coins+" DazCoin",document.getElementById("resetsIn").innerText="Shop refreshes in "+e.refreshesInEnglish;document.getElementById("shopArea").childNodes.length;)document.getElementById("shopArea").removeChild(document.getElementById("shopArea").childNodes[0]);let t=e.userInfo.shopInfo.split("|");t.shift(),t.forEach(t=>{let o=!1;e.shop=e.shop.filter(e=>e.itemID!==t||!1!==o||(o=!0,!1))});for(let t=0;t<e.shop.length;t++){const o=e.shop[t];document.getElementById("shopArea").innerHTML+=`<div class="col-md-6 col-lg-4" style="/*transform: translateY(100%);*/">\n\t\t<div class="card shopCard"><img class="card-img-top w-100 d-block" src="${o.image}" />\n\t\t\t<div class="card-body">\n\t\t\t\t<h4 class="card-title">${o.itemName}</h4>\n\t\t\t\t<h6 class="text-center card-title" style="color:${rarityColors[o.rarity]};">${o.rarity.toUpperCase().replace(/_/g," ")}</h6>\n\t\t\t\t<p class="card-text">${o.itemLore}</p>\n\t\t\t</div>\n\t\t\t<div><button class="btn btn-outline-primary btn-sm" type="button" style="color:${rarityColors[o.rarity]};border-color:${rarityColors[o.rarity]}" id="${o.itemID}" onClick="onClick(this)">BUY (${o.price} DC)</button></div>\n\t\t</div>\n\t</div>`}Array.from(document.getElementsByClassName("unblur")).forEach(e=>e.classList.remove("unblur"))}async function onClick(e){if(document.getElementById("itemImg").src=e.parentNode.parentNode.childNodes[0].src,document.getElementById("closeButton").style="display: none;",document.getElementById("text").innerText="Purchasing reqeusted item...",popup.style=shownStyle,open)return;open=!0;let t=await fetch((localStorage.getItem("dev")?"http://localhost:8080":"https://api.dazai.app")+"/eco/purchaseFromShop",{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},method:"POST",body:JSON.stringify({item:e.id})});return open=!1,document.getElementById("closeButton").style="",t.ok?await t.json()?void window.location.reload():document.getElementById("text").innerHTML="Purchase Failed!</br>Reason:</br><code>You do not have enough Daz Coins!</code>":document.getElementById("text").innerHTML=`Purchase Failed!</br>Reason:</br><code>${await t.json()}</code>`}async function closePopup(){popup.style=hiddenStyle}hi();