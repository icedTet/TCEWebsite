function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,r){e[a]=r}));return e}function delet(e,t,a,r,o){alert([e,t,a,r,o].join(" | "))}function httpGet(e){return e={code:JSON.parse(localStorage.getItem("DazaiAPIData")).authToken},new Promise((function(t,a){try{const a=new XMLHttpRequest,r="https://api.dazai.app/api/getInventory";a.open("POST",r);a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onreadystatechange=e=>{4!=a.readyState&&"complete"!=a.readyState||t(a.responseText)},a.send(JSON.stringify(e))}catch(e){console.log(e)}}))}function getTrade(e){return new Promise((function(t,a){const r=new XMLHttpRequest;r.open("POST","https://api.dazai.app/api/get-trade");r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.onreadystatechange=e=>{4!=r.readyState&&"complete"!=r.readyState||t(r.responseText)},r.send(JSON.stringify(e))}))}function login(e){return new Promise((function(t,a){e.url="https://dazai.app/trade/";const r=new XMLHttpRequest;r.open("POST","https://api.dazai.app/api/login");r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.onreadystatechange=e=>{4!=r.readyState&&"complete"!=r.readyState||t(r.responseText)},console.log(e),r.send(JSON.stringify(e))}))}function CapEach(e){let t=e.split(" ");return t=t.map(e=>e.split("")),t=t.map(e=>(e[0]=e[0].toUpperCase(),e.join(""))),t.join(" ")}function acceptTrade(){localStorage.getItem("DazaiAPIData")||window.location.href("https://discord.com/api/oauth2/authorize?client_id=747901310749245561&redirect_uri=https%3A%2F%2Fdazai.app%2Ftrade&response_type=code&scope=identify");let e=getUrlVars("id");e.code=JSON.parse(localStorage.getItem("DazaiAPIData")).authToken;const t=new XMLHttpRequest;t.open("POST","https://api.dazai.app/api/accept-trade");t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onreadystatechange=e=>{if(4==t.readyState||"complete"==t.readyState){let e=JSON.parse(t.responseText);if("relog"===e&&(alert("Invalid Session."),localStorage.clear(),window.location.replace("http://dazai.app/self/")),e.failed)return void alert(e.reason);console.log(t.responseText),alert("Trade Complete!")}},console.log(e),t.send(JSON.stringify(e))}async function yes(){var e=getUrlVars("code");let t=!0;if(localStorage.getItem("DazaiAPIData")||!e||e.code||(t=!1),!localStorage.getItem("DazaiAPIData")&&e&&e.code){let t=await login(e);localStorage.removeItem("DazaiAPIData"),localStorage.setItem("DazaiAPIData",t),window.location.replace("http://dazai.app/self/")}let a=JSON.parse(await getTrade(getUrlVars("id")));if(!a)return alert("Invalid Trade ID!");console.log(a);let r=a.trade.tradegive,o=a.trade.tradetake;if(document.getElementById("lengthA").style="width: "+(20*a.user.name.length+350)+"px;text-align: right;",document.getElementById("traderName").innerHTML=a.user.name+'<img id="traderPic" src="'+a.user.avatar+'" width="48" height="48" style="margin-left: 50px;border-radius:10px" />',a.user2?document.getElementById("traderName-1").innerHTML=a.user2.name+'<img id="traderPic-1" src="'+a.user2.avatar+'" width="48" height="48" style="margin-left: 50px;border-radius:10px" />':(document.getElementById("unhidecard-1").remove(),document.getElementById("tradeBtn").remove()),document.getElementById("unhidecard").style="margin-left: 25px;",t){let e=JSON.parse(await httpGet({})).inventory;console.log(e),r=r.map(t=>(console.log(t),t.amount=e.filter(e=>(e.id+"").toLowerCase()===(t.itemID+"").toLowerCase()).length,t)),o=o.map(t=>(t.amount=e.filter(e=>(e.id+"").toLowerCase()===(t.itemID+"").toLowerCase()).length,t))}else r=r.map(e=>(console.log(e),e.amount="N/A",e)),o=o.map(e=>(e.amount="N/A",e));t||a.user2||(document.getElementById("tradeBtn").innerHTML="Sign in to Trade!");let n=document.getElementById("group1"),s=document.getElementById("group2");r.forEach(e=>{n.innerHTML+='<div class="card shadow-lg" style="border-radius: 12px;border-style: none;"><img class="card-img-top w-100 d-block" src="'+e.image+'" />            <div class="card-body">                <h4 class="card-title" style="font-size: 24px;">'+e.itemName+'</h4>                <p class="card-text" style="color: rgb(220,220,220);font-size: 12px;margin-top: -15px;">id: <code>'+e.itemID+"</code></p>                "+(0!==e.isNumbered?'<p class="card-text" style="color: rgb(220,220,220);font-size: 12px;margin-top: 0px;">Serial Number: <code>'+e.serial+"</code></p>":"")+'                <p class="card-text">'+e.rarity.replace(/\_/g," ").toUpperCase()+'</p>                <p class="card-text" style="font-size: 12px;color: rgb(255,255,255);">You own '+e.amount+" of this</p>            </div>        </div>"}),o.forEach(e=>{s.innerHTML+='<div class="card shadow-lg" style="border-radius: 12px;border-style: none;"><img class="card-img-top w-100 d-block" src="'+e.image+'" />            <div class="card-body">                <h4 class="card-title" style="font-size: 24px;">'+e.itemName+'</h4>                <p class="card-text" style="color: rgb(220,220,220);font-size: 12px;margin-top: -15px;">id: <code>'+e.itemID+"</code></p>                "+(0!==e.isNumbered?'<p class="card-text" style="color: rgb(220,220,220);font-size: 12px;margin-top: 0px;">Serial Number: <code>'+e.serial+"</code></p>":"")+'                <p class="card-text">'+e.rarity.replace(/\_/g," ").toUpperCase()+'</p>                <p class="card-text" style="font-size: 12px;color: rgb(255,255,255);">You own '+e.amount+" of this</p>            </div>        </div>"});for(var i=0;i<6-r.length;i++)n.innerHTML+='<div class="card shadow-lg" style="border-radius: 12px;border-style: none;"></div>';for(i=0;i<6-o.length;i++)s.innerHTML+='<div class="card shadow-lg" style="border-radius: 12px;border-style: none;"></div>'}yes();